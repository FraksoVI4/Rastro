# Rastro - Растровый редактор

## Текущее состояние проекта
Растровый редактор с базовым набором инструментов для рисования, поддержкой изменения размера холста и системой отмены действий. 

## Структура проекта
```
src/
├── __init__.py
├── main.py                 # Точка входа в приложение
├── gui/
│   ├── __init__.py
│   ├── main_window.py     # Главное окно приложения
│   └── canvas.py          # Холст для рисования
├── tools/
│   ├── __init__.py
│   ├── base_tool.py       # Базовый класс инструментов
│   ├── brush.py           # Инструмент кисть
│   ├── line.py            # Инструмент линия
│   └── eraser.py          # Инструмент ластик
└── utils/
    ├── __init__.py
    ├── logger.py          # Настройка логирования
    └── history_manager.py # Менеджер истории действий
```

## Компоненты

### Canvas (gui/canvas.py)
Основной компонент для рисования. Наследуется от QWidget и обеспечивает:
- Отрисовку на холсте
- Обработку событий мыши
- Прокрутку при большом размере холста
- Взаимодействие с инструментами рисования
- Поддержку отмены/повтора действий рисования

### MainWindow (gui/main_window.py)
Главное окно приложения:
- Управление инструментами через панель инструментов
- Изменение размера холста через меню
- Информативный статусбар (текущий инструмент и размер)
- Горячие клавиши

### Tools (tools/*.py)
Инструменты рисования на основе паттерна "Стратегия":
- BaseTool: Абстрактный базовый класс для всех инструментов
- BrushTool: Инструмент для свободного рисования
- LineTool: Инструмент для рисования прямых линий
- EraserTool: Инструмент для стирания

### History Manager (utils/history_manager.py)
Система управления историей действий:
- Хранение состояний холста
- Ограничение количества сохраненных состояний
- Поддержка отмены/повтора действий рисования

### Logger (utils/logger.py)
Система логирования:
- Запись в файл (уровень DEBUG)
- Вывод в консоль (уровень INFO)
- Русскоязычные сообщения

## Горячие клавиши
- B - выбор кисти
- L - выбор линии
- E - выбор ластика
- Ctrl+Z - отмена действия
- Ctrl+Y или Ctrl+Shift+Z - повтор действия
- Ctrl+R - изменение размера холста

## Зависимости
```
PyQt6==6.5.0
```

## Запуск проекта
1. Установить зависимости:
```bash
pip install -r requirements.txt
```

2. Запустить приложение:
```bash
python src/main.py
```

## История изменений

### Коммит 1: Базовая структура
- Создана структура проекта
- Добавлен базовый функционал холста
- Настроено логирование

### Коммит 2: Система отмены/повтора действий
- Добавлен менеджер истории (HistoryManager)
- Реализована возможность отмены/повтора действий
- Добавлены кнопки отмены/повтора на панели инструментов
- Добавлены горячие клавиши Ctrl+Z (отмена) и Ctrl+Y/Ctrl+Shift+Z (повтор)

### Коммит 3: Улучшение функционала
- Добавлен инструмент для рисования линий
- Добавлена возможность изменения размера холста через меню
- Добавлена прокрутка для больших холстов
- Добавлен информативный статусбар
- Исправлены баги с отменой действий

## План развития
1. ✅ Базовая структура проекта
2. ✅ Рабочий холст с базовым функционалом
3. ✅ Система отмены/повтора действий
4. ✅ Изменение размера холста
5. ⬜ Выбор цвета
6. ⬜ Настройка размера инструментов
7. ⬜ Сохранение/загрузка изображений
8. ⬜ Новые инструменты (прямоугольник, круг)

## Текущие задачи
1. Реализовать выбор цвета
2. Добавить изменение размера кисти
3. Реализовать сохранение в файл
4. Добавить новые инструменты (прямоугольник, круг)
5. Добавить выбор стиля линий

## Особенности реализации
1. Прокрутка для больших холстов
2. Инструменты реализованы через паттерн "Стратегия"
3. Логирование всех действий пользователя
4. Модульная структура для простоты расширения
5. История действий с ограничением в 30 шагов

## Заметки по разработке
1. При добавлении новых инструментов наследоваться от BaseTool
2. Все сообщения пользователю и логи на русском
3. Использовать систему логирования для отладки
4. Следовать структуре проекта при добавлении новых компонентов
5. Вся работа с изображением происходит через QImage